# WordPress Helm Chart - í”„ë¡œì íŠ¸ ìš”ì•½

## ğŸ“¦ í”„ë¡œì íŠ¸ ê°œìš”

**ëª©í‘œ**: í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ ì•ˆì •ì ìœ¼ë¡œ ìš´ì˜ ê°€ëŠ¥í•œ WordPress Helm ì°¨íŠ¸

**ì£¼ìš” íŠ¹ì§•**:
- âœ… ê³µì‹ WordPress ì´ë¯¸ì§€ (Apache ë‚´ì¥)
- âœ… MariaDB StatefulSet ê¸°ë°˜ ë°ì´í„°ë² ì´ìŠ¤
- âœ… Nginx Ingress + Let's Encrypt SSL ì§€ì›
- âœ… PVC ê¸°ë°˜ ì˜êµ¬ ìŠ¤í† ë¦¬ì§€
- âœ… ì™„ì „í•œ ìš´ì˜ ë¬¸ì„œ ì œê³µ

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Nginx Ingress                      â”‚
â”‚              (dyibs.com + SSL/TLS)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            WordPress Service (ClusterIP)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         WordPress Deployment (Apache)               â”‚
â”‚  - wordpress:latest-apache                         â”‚
â”‚  - Replicas: 1 (í™•ì¥ ê°€ëŠ¥)                         â”‚
â”‚  - Resources: 256Mi-1Gi RAM                        â”‚
â”‚  - Health checks: liveness + readiness             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                  â”‚
               â–¼                  â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  WordPress PVC   â”‚   â”‚  MariaDB Service â”‚
   â”‚  local-path      â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚  500Mi           â”‚            â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ MariaDB StatefulSet  â”‚
                        â”‚ - mariadb:11.2       â”‚
                        â”‚ - Replicas: 1        â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   MariaDB PVC        â”‚
                        â”‚   local-path         â”‚
                        â”‚   500Mi              â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ íŒŒì¼ êµ¬ì¡°

```
wordpress-chart/
â”œâ”€â”€ Chart.yaml                    # Helm ì°¨íŠ¸ ë©”íƒ€ë°ì´í„°
â”œâ”€â”€ values.yaml                   # ê¸°ë³¸ ì„¤ì •
â”œâ”€â”€ .helmignore                   # Helm íŒ¨í‚¤ì§• ì œì™¸ íŒŒì¼
â”‚
â”œâ”€â”€ README.md                     # ì „ì²´ ì‚¬ìš© ì„¤ëª…ì„œ
â”œâ”€â”€ QUICKSTART.md                 # ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ
â”œâ”€â”€ SUMMARY.md                    # ì´ íŒŒì¼
â”‚
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ _helpers.tpl             # Helm í…œí”Œë¦¿ í—¬í¼ í•¨ìˆ˜
â”‚   â”œâ”€â”€ NOTES.txt                # ì„¤ì¹˜ í›„ ì•ˆë‚´ ë©”ì‹œì§€
â”‚   â”‚
â”‚   â”œâ”€â”€ wordpress-deployment.yaml # WordPress ì• í”Œë¦¬ì¼€ì´ì…˜
â”‚   â”œâ”€â”€ wordpress-service.yaml    # WordPress ì„œë¹„ìŠ¤
â”‚   â”œâ”€â”€ wordpress-pvc.yaml        # WordPress ì˜êµ¬ ë³¼ë¥¨
â”‚   â”œâ”€â”€ wordpress-nfs-pv.yaml     # NFS ì˜êµ¬ ë³¼ë¥¨
â”‚   â”œâ”€â”€ wordpress-nfs-pvc.yaml    # NFS ì˜êµ¬ ë³¼ë¥¨ í´ë ˆì„
â”‚   â”‚
â”‚   â”œâ”€â”€ mariadb-statefulset.yaml # MariaDB ë°ì´í„°ë² ì´ìŠ¤
â”‚   â”œâ”€â”€ mariadb-service.yaml     # MariaDB ì„œë¹„ìŠ¤
â”‚   â”œâ”€â”€ secret.yaml              # ë¹„ë°€ë²ˆí˜¸ ê´€ë¦¬
â”‚   â”‚
â”‚   â””â”€â”€ ingress.yaml             # Nginx Ingress + cert-manager
â”‚
â””â”€â”€ charts/                      # í•˜ìœ„ ì°¨íŠ¸ (í˜„ì¬ ë¹„ì–´ìˆìŒ)
```

## ğŸ¯ í•µì‹¬ ê¸°ëŠ¥

### 1. ì˜êµ¬ ìŠ¤í† ë¦¬ì§€
- **WordPress PVC**: local-path StorageClass ì‚¬ìš©
- **MariaDB PVC**: StatefulSet volumeClaimTemplates
- **ë°ì´í„° ë³´í˜¸**: PVC ìë™ ë³´ì¡´ ì •ì±…

### 2. SSL/TLS ì§€ì›
- cert-manager ClusterIssuer í†µí•©
- Let's Encrypt ìë™ ì¸ì¦ì„œ ë°œê¸‰
- ìë™ HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸
- ë©€í‹° ë„ë©”ì¸ ì§€ì› (dyibs.com, dyibs.co.kr)

### 3. í”„ë¡œë•ì…˜ ì¤€ë¹„
- Apache ê¸°ë°˜ ê³µì‹ WordPress ì´ë¯¸ì§€
- Health checks (liveness/readiness probes)
- Resource limits ì„¤ì •
- Rolling update ì „ëµ

### 4. í™•ì¥ì„±
- ìˆ˜í‰ í™•ì¥ (replicas)
- ìˆ˜ì§ í™•ì¥ (resources)
- ìŠ¤í† ë¦¬ì§€ í™•ì¥

## ğŸš€ ì‚¬ìš© ë°©ë²•

### ë¹ ë¥¸ ì‹œì‘ (5ë¶„)

```bash
# 1. ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±
kubectl create namespace wp

# 2. values.yaml ì„¤ì • (ë¹„ë°€ë²ˆí˜¸ ë“±)

# 3. Helm ì°¨íŠ¸ ì„¤ì¹˜
helm install wp . -n wp

# 4. í™•ì¸
kubectl get pods -n wp -w
curl -I https://dyibs.com
```

ìì„¸í•œ ë‚´ìš©ì€ [QUICKSTART.md](./QUICKSTART.md) ì°¸ì¡°

### values.yaml ì£¼ìš” ì„¤ì •

```yaml
wordpress:
  image:
    repository: wordpress
    tag: "latest"                # Apache ë‚´ì¥ ì´ë¯¸ì§€

  persistence:
    storageClass: "local-path"
    size: 500Mi

  ingress:
    enabled: true
    className: "nginx"
    hosts:
      - host: dyibs.com
      - host: dyibs.co.kr
      - host: www.dyibs.com
      - host: www.dyibs.co.kr
    tls:
      - secretName: dyibs.com-tls

mariadb:
  enabled: true
  auth:
    database: wordpress
    username: wordpress
    password: ""                 # ì„¤ì • í•„ìš”
    rootPassword: ""             # ì„¤ì • í•„ìš”

  primary:
    persistence:
      storageClass: "local-path"
      size: 500Mi
```

## ğŸ“Š Apache ì„ íƒ ê·¼ê±°

**Apache ì„ íƒ ì´ìœ **:
1. âœ… ê³µì‹ WordPress ì´ë¯¸ì§€ ê¸°ë³¸ ì œê³µ
2. âœ… ë‹¨ì¼ ì»¨í…Œì´ë„ˆë¡œ ê°„ë‹¨í•œ êµ¬ì„±
3. âœ… .htaccess ì§€ì› (WordPress í”ŒëŸ¬ê·¸ì¸ í˜¸í™˜ì„±)
4. âœ… ë¹ ë¥¸ ë°°í¬ ë° ìš´ì˜ ì‹œì‘
5. âœ… ë‚®ì€ ë³µì¡ë„, ë†’ì€ ì•ˆì •ì„±

**í–¥í›„ ìµœì í™” ê²½ë¡œ**:
- í˜„ì¬: Apacheë¡œ ì•ˆì •ì  ìš´ì˜
- í•„ìš”ì‹œ: Nginxë¡œ ì„±ëŠ¥ ìµœì í™” ê°€ëŠ¥

## ğŸ”’ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

1. **Secret ê´€ë¦¬**
   - WordPress ë¹„ë°€ë²ˆí˜¸: Kubernetes Secret
   - MariaDB ë¹„ë°€ë²ˆí˜¸: Kubernetes Secret
   - TLS ì¸ì¦ì„œ: cert-manager ê´€ë¦¬

2. **ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ**
   - ClusterIP ì„œë¹„ìŠ¤ (ì™¸ë¶€ ì§ì ‘ ë…¸ì¶œ ì—†ìŒ)
   - Ingressë¥¼ í†µí•œ ì œì–´ëœ ì ‘ê·¼
   - ê°•ì œ HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸

3. **ë¦¬ì†ŒìŠ¤ ì œí•œ**
   - CPU/Memory limits ì„¤ì •
   - PVC í¬ê¸° ì œí•œ

## ğŸ“ˆ í™•ì¥ì„±

### ìˆ˜í‰ í™•ì¥ (Horizontal Scaling)

```yaml
wordpress:
  replicaCount: 3  # ì—¬ëŸ¬ replicaë¡œ í™•ì¥ ê°€ëŠ¥
```

### ë¦¬ì†ŒìŠ¤ í™•ì¥ (Vertical Scaling)

```yaml
wordpress:
  resources:
    limits:
      cpu: 2000m
      memory: 2Gi
```

### ìŠ¤í† ë¦¬ì§€ í™•ì¥

```bash
# PVC í¬ê¸° ì¦ê°€ (ìŠ¤í† ë¦¬ì§€ í´ë˜ìŠ¤ê°€ ì§€ì›í•˜ëŠ” ê²½ìš°)
kubectl patch pvc -n wp wordpress -p '{"spec":{"resources":{"requests":{"storage":"1Gi"}}}}'
```

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì™„ë£Œ í•­ëª©

- [x] Helm lint ê²€ì¦
- [x] Template ë Œë”ë§ í…ŒìŠ¤íŠ¸
- [x] values.yaml ê¸°ë³¸ê°’ ê²€ì¦
- [x] Ingress + TLS ì„¤ì •
- [x] Secret ìƒì„± ë¡œì§
- [x] MariaDB StatefulSet ì„¤ì •
- [x] Helper í…œí”Œë¦¿ í•¨ìˆ˜

## ğŸ“ ë¬¸ì„œ

| íŒŒì¼ | ëª©ì  | ëŒ€ìƒ |
|------|------|------|
| **QUICKSTART.md** | ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ | ë°”ë¡œ ì‹œì‘í•˜ê³  ì‹¶ì€ ì‚¬ìš©ì |
| **README.md** | ì „ì²´ ì‚¬ìš© ì„¤ëª…ì„œ | Chart ê¸°ëŠ¥ ì „ì²´ ì´í•´ |
| **values.yaml** | ì„¤ì • ì°¸ì¡° | ì»¤ìŠ¤í„°ë§ˆì´ì§• í•„ìš” ì‹œ |

## ğŸ› ï¸ ì£¼ìš” ëª…ë ¹ì–´

```bash
# ì„¤ì¹˜
helm install wp . -n wp

# ì—…ê·¸ë ˆì´ë“œ
helm upgrade wp . -n wp

# ìƒíƒœ í™•ì¸
helm status wp -n wp

# ê°’ í™•ì¸
helm get values wp -n wp

# ì‚­ì œ (PVCëŠ” ìœ ì§€ë¨)
helm uninstall wp -n wp

# Dry-run
helm install wp . -n wp --dry-run --debug

# í…œí”Œë¦¿ í™•ì¸
helm template wp . -n wp
```

## ğŸš¨ ì£¼ì˜ì‚¬í•­

1. **ë¹„ë°€ë²ˆí˜¸ í•„ìˆ˜**: values.yamlì— ì˜¬ë°”ë¥¸ MariaDB ë¹„ë°€ë²ˆí˜¸ ì„¤ì • í•„ìˆ˜
2. **ë°±ì—…**: ì •ê¸°ì ì¸ ë°ì´í„°ë² ì´ìŠ¤ ë° íŒŒì¼ ë°±ì—… ê¶Œì¥
3. **ë³´ì•ˆ**: Gitì— ë¹„ë°€ë²ˆí˜¸ ì»¤ë°‹í•˜ì§€ ì•Šë„ë¡ ì£¼ì˜

## ğŸ“ í•™ìŠµ ìë£Œ

- **Apache ì„¤ì •**: ê³µì‹ WordPress ì´ë¯¸ì§€ ë¬¸ì„œ
- **MariaDB ì„¤ì •**: MariaDB ê³µì‹ ë¬¸ì„œ
- **Helm ì°¨íŠ¸**: Helm ê³µì‹ ê°€ì´ë“œ
- **Kubernetes**: PVC, StatefulSet, Deployment ê°œë…

## ğŸ’¡ Best Practices

1. **ë°±ì—…**: ì •ê¸°ì ì¸ ë°ì´í„°ë² ì´ìŠ¤ ë° íŒŒì¼ ë°±ì—…
2. **ëª¨ë‹ˆí„°ë§**: Prometheus + Grafana ì—°ë™ ê¶Œì¥
3. **ë³´ì•ˆ**: ì •ê¸°ì ì¸ WordPress ë° í”ŒëŸ¬ê·¸ì¸ ì—…ë°ì´íŠ¸
4. **ì„±ëŠ¥**: í•„ìš”ì‹œ CDN ë° ìºì‹± í”ŒëŸ¬ê·¸ì¸ ì‚¬ìš©
5. **í™•ì¥**: íŠ¸ë˜í”½ ì¦ê°€ ì‹œ replica ìˆ˜í‰ í™•ì¥

## ğŸ‰ ì™„ë£Œ!

ì´ Helm ì°¨íŠ¸ëŠ” í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ WordPressë¥¼ ì•ˆì „í•˜ê³  íš¨ìœ¨ì ìœ¼ë¡œ ìš´ì˜í•˜ê¸° ìœ„í•œ ëª¨ë“  êµ¬ì„±ìš”ì†Œë¥¼ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.

**ë‹¤ìŒ ë‹¨ê³„**:
1. [QUICKSTART.md](./QUICKSTART.md)ë¥¼ ì½ê³  ì„¤ì¹˜ ì‹œì‘
2. values.yaml ì»¤ìŠ¤í„°ë§ˆì´ì§•
3. í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ë¨¼ì € ê²€ì¦
4. í”„ë¡œë•ì…˜ ë°°í¬ ìˆ˜í–‰
5. ëª¨ë‹ˆí„°ë§ ë° ìµœì í™”

ë¬¸ì œê°€ ìˆìœ¼ì‹œë©´ [README.md](./README.md)ì˜ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ì„¹ì…˜ì„ ì°¸ì¡°í•˜ì„¸ìš”.